# Image Processing

![C++](https://img.shields.io/badge/C++-11%2B-green)
[![License: MIT](https://img.shields.io/badge/License-MIT-blue.svg)](LICENSE)
![Build](https://img.shields.io/badge/build-manual-lightgrey)
[![Docs](https://img.shields.io/badge/doc-Doxygen-purple)](./doc/index.html)

This repository features an image processing program that applies grayscale transformation to batches of images. These images are retrieved from a list of URLs pointing to public domain images available on the Web. The program downloads each image and converts it to grayscale. In the current version, the list of image URLs is generated by a lightweight generative artificial intelligence (AI) model.

---

## üìÇ Repository Structure

This repository is structured as follows:

```
.
‚îú‚îÄ‚îÄ doc/                        # Documentation
‚îú‚îÄ‚îÄ Doxygen                     # Configuration file for generating documentation with Doxygen
‚îú‚îÄ‚îÄ include/                    # Libraries to include
‚îÇ   ‚îú‚îÄ‚îÄ json.hpp                # JSON library
‚îú‚îÄ‚îÄ Makefile                    # Makefile for compilation
‚îú‚îÄ‚îÄ src/                        # Source code
‚îÇ   ‚îú‚îÄ‚îÄ imageprocessing.cpp     # Program to process images
‚îî‚îÄ‚îÄ README.md
```

---

## üíª Getting Started

### üìã Prerequisites

The following elements must be properly installed on the development environment to compile and run the program:

- [curl](https://curl.se/), for making HTTP requests
- [*GNU Compiler Collection*](https://gcc.gnu.org) (which includes the `gcc` and `g++` compilers), [`clang`](https://clang.llvm.org/) or any other compiler for the C and C++ programming languages
- [*GNU Make*](https://www.gnu.org/software/make/), for compiling via makefile
- [Doxygen](https://www.doxygen.nl), for automatic documentation generation
- [OpenCV](https://opencv.org/), for processing images

### ü§ñ Integration with Google Gemini

The current implementation of this project utilizes [Google Gemini 2.5 Flash-Lite](https://ai.google.dev/gemini-api/docs/models) as the IA model to generate the list of image URLs. The integration with Google Gemini is done the [Gemini API](https://ai.google.dev/api), more precisely through HTTP POST requests. Making direct requests is necessary because Google GenAI does not provide an SDK for C++ to abstract calls to the methods defined in the API.

Interacting with the Gemini API requires an [API key](https://ai.google.dev/gemini-api/docs/api-key). In the current implementation, the API key is [explicitly provided](https://ai.google.dev/gemini-api/docs/api-key#provide-api-key-explicitly) from a file. A personal, work, or school Google account is needed to create a project and an API key via [Google AI Studio](https://aistudio.google.com/app/api-keys).

The `generateImageUrls` function generates the list of image URLs. It uses two prompts submitted to Google Gemini via an HTTP POST request. The first one requests the generation of image URLs:

```
Generate {numimages} public domain image URLs (either JPEG or PNG format) from trusted 
public domain image repositories. Exclude Wikimedia Commons and related sites.
The URL must directly point to a valid image file ending with .jpg or .png, and the 
file size must be less than 200 KB. Provide the final image URLs in plain text.
```

However, there is no guarantee that this prompt generates only the list of image URLs. To circumvent this issue, a second prompt is used to retrieve only the list of URLs from the output of the first prompt:

```
Extract all URLs from the following contents into a plain text list. Each URL must be 
on a new line. These are the contents: {output of the first prompt}
```

### ‚òëÔ∏è URL validity check

To avoid generating a URL to an image that is not directly accessible (e.g., image not found, redirecting to another page where the image is posted, etc.), an HTTP GET request is done for each generated URL. In case of the URL is inaccessible, another URL is generated. This is done until reaching the number of URLs defined for the program.

### ‚ñ∂Ô∏è Compiling and running the program

This repository contains a [Makefile](Makefile). The following command builds the program:

```bash
make
```

The command will generate object files into `build` directory and the executable program into `bin` directory. These directories are automatically created in the first run of the [`Makefile`](Makefile).

The following command executes the generated program, `imageprocessing`:

```bash
 ./bin/imageprocessing 5
```

In this case, the program will process five images. The downloaded images are saved into the `images` directory and their grayscale versions into the `gs-images` directory.

### üóíÔ∏è Generating documentation

The generation of documentation is provided by [Doxygen](https://www.doxygen.nl). This process can be done either using the [Doxygen GUI](https://www.doxygen.nl/download.html) or manually using the command line.

#### Using the Doxygen GUI

After downloading and installing the Doxygen GUI, the wizard can assist with creating and customizing the [Doxyfile](Doxyfile), the configuration file for the documentation generation, as well as running the documentation generation. The Doxyfile is a very long file, so using the tool is recommended to quickly locate specific tags to change.

#### Using the command line

This command generates the [`Doxyfile`](Doxyfile):

```bash
doxygen -g
```

This command generates the documentation itself:

```bash
doxygen
```

This command will generate documentation for all source code files within the [`src`](src) directory and place it in the [`doc`](doc) directory. The [Doxyfile](Doxyfile) provided in this repository allows for the automatic generation of documentation as HTML pages.

---

## ü§ù Contributing

Contributions are welcome! Fork this repository and submit a pull request üöÄ

---

## üìú License

This project is licensed under the [MIT License](LICENSE).
